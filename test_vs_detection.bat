@echo off
echo =============================================\necho Testing Visual Studio Detection\necho =============================================\necho.\n\necho Testing batch detection script...\necho.\nif exist \"detect_vs.bat\" (\n    call \"detect_vs.bat\"\n    if %VS_FOUND% equ 1 (\n        echo.\n        echo ===== BATCH DETECTION RESULTS =====\n        echo VS_FOUND=%VS_FOUND%\n        echo VS_PATH=%VS_PATH%\n        echo VS_EDITION=%VS_EDITION%\n        echo VS_VERSION=%VS_VERSION%\n        echo VSIX_INSTALLER=%VSIX_INSTALLER%\n        echo DETECTION_METHOD=%DETECTION_METHOD%\n    ) else (\n        echo Batch detection failed\n    )\n) else (\n    echo detect_vs.bat not found\n)\n\necho.\necho =============================================\necho Testing PowerShell detection script...\necho =============================================\necho.\n\nif exist \"detect_vs.ps1\" (\n    powershell -NoProfile -ExecutionPolicy Bypass -File \"detect_vs.ps1\" -ShowAll\n) else (\n    echo detect_vs.ps1 not found\n)\n\necho.\necho =============================================\necho Testing PowerShell JSON output...\necho =============================================\necho.\n\nif exist \"detect_vs.ps1\" (\n    powershell -NoProfile -ExecutionPolicy Bypass -File \"detect_vs.ps1\" -JsonOutput\n) else (\n    echo detect_vs.ps1 not found\n)\n\necho.\necho =============================================\necho Testing manual vswhere.exe...\necho =============================================\necho.\n\nif exist \"%ProgramFiles(x86)%\\Microsoft Visual Studio\\Installer\\vswhere.exe\" (\n    echo Running vswhere.exe directly...\n    \"%ProgramFiles(x86)%\\Microsoft Visual Studio\\Installer\\vswhere.exe\" -version [17.0,18.0) -format table\n    echo.\n    echo Detailed JSON output:\n    \"%ProgramFiles(x86)%\\Microsoft Visual Studio\\Installer\\vswhere.exe\" -version [17.0,18.0) -format json\nelse (\n    echo vswhere.exe not found at standard location\n)\n\necho.\necho =============================================\necho Test completed\necho =============================================\npause